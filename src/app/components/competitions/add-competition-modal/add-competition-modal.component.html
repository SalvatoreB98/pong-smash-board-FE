<app-step-indicator [activeStep]="step" [totalSteps]="6"></app-step-indicator>

<!-- STEP 1 – MANAGEMENT -->
<div class="steps-wrapper" *ngIf="step == 1">
    <form class="form-card m-auto mt-3" [formGroup]="managementForm">
        <div class="field">
            <span class="label">{{ 'management_type' | translate }}</span>
            <div class="container-choose">
                <div class="segmented" role="radiogroup" [attr.aria-label]="'management_type' | translate">
                    <label class="seg-item">
                        <input type="radio" value="admin" formControlName="managementCtrl" />
                        <span class="large-img-select">
                            <span>{{ 'admin_only' | translate }}</span>
                            <div class="mt-4">
                                <i class="fa fa-user fa-3x" aria-hidden="true"></i>
                                <i class="fa fa-lock ms-1" aria-hidden="true"></i>
                            </div>
                            <p class="mt-3">{{ 'management_type_admin' | translate }}</p>
                        </span>
                    </label>
                    <label class="seg-item">
                        <input type="radio" value="self" formControlName="managementCtrl" />
                        <span class="large-img-select">
                            <span>{{ 'free_management' | translate }}</span>
                            <div class="mt-4">
                                <i class="fa fa-users fa-3x" aria-hidden="true"></i>
                                <i class="fa fa-unlock" aria-hidden="true"></i>
                            </div>
                            <p class="mt-3">{{ 'management_type_self' | translate }}</p>
                        </span>
                    </label>
                </div>
            </div>

            <span class="label mt-5">{{ 'is_part_of_competition' | translate }}</span>
            <div class="segmented" role="radiogroup" [attr.aria-label]="'is_part_of_competition' | translate">
                <label class="seg-item">
                    <input type="radio" formControlName="isPartOfCompetitionCtrl" [value]="true" />
                    <span>{{ 'yes' | translate }}</span>
                </label>
                <label class="seg-item">
                    <input type="radio" formControlName="isPartOfCompetitionCtrl" [value]="false" />
                    <span>{{ 'no' | translate }}</span>
                </label>
            </div>
        </div>
    </form>
</div>

<!-- STEP 2 – NOME -->
<div class="steps-wrapper" *ngIf="step == 3">
    <form class="form-card m-auto mt-3" [formGroup]="competitionForm" (keydown.enter)="nextStep()">
        <label class="field">
            <span class="label">{{ 'competition_name_label' | translate }}</span>
            <input class="input" type="text" [placeholder]="'competition_name_placeholder' | translate"
                formControlName="nameCtrl" autocomplete="off" />
            <small class="error" *ngIf="nameCtrl.invalid && nameCtrl.touched">
                {{ 'competition_name_error_minlength' | translate }}
            </small>
        </label>
    </form>
</div>

<!-- STEP 3 – TIPOLOGIA -->
<div class="steps-wrapper" *ngIf="step == 2">
    <form class="form-card m-auto mt-3" [formGroup]="competitionForm" (keydown.enter)="nextStep()">
        <div class="field">
            <span class="label">{{ 'competition_type_label' | translate }}</span>
            <div class="segmented" role="radiogroup" [attr.aria-label]="'competition_type_label' | translate">
                <label class="seg-item" *ngFor="let type of getCompetitionTypes()" [class.disabled]="type.disabled">
                    <ng-container *ngIf="!type.disabled; else disabledType">
                        <input type="radio" [value]="type.value" formControlName="typeCtrl" />
                        <span class="large-img-select">
                            <span class="label-text">{{ type.labelKey | translate }}</span>
                            <img [src]="type.icon" [attr.alt]="type.labelKey | translate" />
                            <span class="badge" *ngIf="type.badgeKey">{{ type.badgeKey | translate }}</span>
                            <p class="description" *ngIf="type.descriptionKey">{{ type.descriptionKey | translate }}</p>
                        </span>
                    </ng-container>
                    <ng-template #disabledType>
                        <span class="large-img-select">
                            <div class="not-available">
                                {{ 'not_available' | translate }}
                                <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
                            </div>
                            <span class="label-text">{{ type.labelKey | translate }}</span>
                            <p class="description" *ngIf="type.descriptionKey">{{ type.descriptionKey | translate }}</p>
                        </span>
                    </ng-template>
                </label>
            </div>
        </div>
        <div *ngIf="managementForm.get('managementCtrl')?.value !== 'admin'">
            <p class="text-danger text-center">{{ 'not_available_description' | translate }}</p>
        </div>
    </form>
</div>

<!-- STEP 4 – SET -->
<div class="steps-wrapper" *ngIf="step == 4">
    <form class="form-card m-auto mt-3" [formGroup]="competitionForm" (keydown.enter)="nextStep()">
        <div class="field">
            <span class="label">{{ 'competition_sets_label' | translate }}</span>
            <div class="segmented" role="radiogroup" [attr.aria-label]="'competition_sets_label' | translate">
                <label class="seg-item">
                    <input type="radio" formControlName="setsCtrl" [value]="1" />
                    <span class="p-4">1</span>
                </label>
                <label class="seg-item">
                    <input type="radio" formControlName="setsCtrl" [value]="2" />
                    <span class="p-4">2</span>
                </label>
                <label class="seg-item">
                    <input type="radio" formControlName="setsCtrl" [value]="3" />
                    <span class="p-4">3</span>
                </label>
                <label class="seg-item">
                    <input type="radio" formControlName="setsCtrl" [value]="5" />
                    <span class="p-4">5</span>
                </label>
            </div>
        </div>
    </form>
</div>

<!-- STEP 5 – PUNTI -->
<div class="steps-wrapper" *ngIf="step == 5" (keydown.enter)="nextStep()">
    <form class="form-card m-auto mt-3" [formGroup]="competitionForm">
        <div class="field">
            <span class="label">{{ 'competition_points_label' | translate }}</span>
            <div class="segmented" role="radiogroup" [attr.aria-label]="'competition_points_label' | translate">
                <label class="seg-item">
                    <input type="radio" formControlName="pointsCtrl" [value]="11" />
                    <span class="p-4">11</span>
                </label>
                <label class="seg-item">
                    <input type="radio" formControlName="pointsCtrl" [value]="21" />
                    <span class="p-4">21</span>
                </label>
            </div>
        </div>
    </form>
</div>

<!-- STEP 6 – RIEPILOGO -->
<div class="steps-wrapper" *ngIf="step == 6">
    <div class="summary form-card mt-3">
        <ul class="list-group list-group-flush">
            <li *ngIf="managementForm.value.isPartOfCompetitionCtrl"
                class="list-group-item text-light d-flex align-items-center">
                <i class="fa fa-user-plus me-2 text-primary"></i>
                <span class="fw-bold me-2">{{ 'is_part_of_competition' | translate }}:</span>
                <span class="ms-auto">{{ 'yes' | translate }}</span>
            </li>
            <li class="list-group-item text-light d-flex align-items-center">
                <i [class]="
            managementForm.value.managementCtrl == 'admin'
              ? 'fa fa-lock me-2 text-warning'
              : 'fa fa-lock-open me-2 text-success'
          "></i>
                <span class="fw-bold me-2">{{ 'management' | translate }}:</span>
                <span class="ms-auto">{{ managementForm.value.managementCtrl | titlecase }}</span>
            </li>
            <li class="list-group-item text-light d-flex align-items-center">
                <i class="fa fa-trophy me-2 text-warning"></i>
                <span class="fw-bold me-2">{{ 'name' | translate }}:</span>
                <span class="ms-auto">{{ competitionForm.value.nameCtrl }}</span>
            </li>
            <li class="list-group-item text-light d-flex align-items-center">
                <i class="fa fa-list me-2 text-info"></i>
                <span class="fw-bold me-2">{{ 'competition_type_label' | translate }}:</span>
                <span class="ms-auto">
                    {{ ('competition_type_' + (competitionForm.value.typeCtrl || 'league')) | translate }}
                </span>
            </li>
            <li class="list-group-item text-light d-flex align-items-center">
                <i class="fa fa-th me-2 text-secondary"></i>
                <span class="fw-bold me-2">{{ 'competition_sets_label' | translate }}:</span>
                <span class="ms-auto">{{ competitionForm.value.setsCtrl }}</span>
            </li>
            <li class="list-group-item text-light d-flex align-items-center">
                <i class="fa fa-star me-2 text-warning"></i>
                <span class="fw-bold me-2">{{ 'competition_points_label' | translate }}:</span>
                <span class="ms-auto">{{ competitionForm.value.pointsCtrl }}</span>
            </li>
        </ul>
    </div>
</div>

<!-- ✅ ACTIONS GLOBALI -->
<div class="actions d-flex justify-content-center mt-4">
    <button class="primary bg-secondary" (click)="back()" [hidden]="step <= 1">
        {{ 'back' | translate }}
    </button>

    <button class="primary" (click)="nextStep()" [hidden]="step >= 6" [disabled]="isNextDisabled()">
        {{ 'next_step' | translate }}
    </button>

    <button class="primary flex-grow-1 ms-auto" (click)="submit()" [hidden]="step < 6"
        [disabled]="competitionForm.invalid">
        {{ 'competition_action_create' | translate }}
    </button>
</div>