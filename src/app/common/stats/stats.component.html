<!-- CLASSIFICA -->
<h2 class="mb-3 mt-4">{{ "classifica" | translate }}</h2>
<div class="stats-header my-container">
  <div class="position">{{ "rank" | translate }}</div>
  <div class="image"></div>
  <div></div>
  <div class="partite-tot" title="{{ 'partiteTotTitle' | translate }}">{{ "partiteTot" | translate }}</div>
  <div class="vittorie" title="{{ 'vittorieTitle' | translate }}">{{ "vittorie" | translate }}</div>
  <div class="sconfitte" title="{{ 'sconfitteTitle' | translate }}">{{ "sconfitte" | translate }}</div>
  <div class="win-rate" title="{{ 'ratingTitle' | translate }}">{{ "rating" | translate }}</div>
  <div class="win-rate" title="{{ 'winRateTitle' | translate }}">{{ "winRate" | translate }}</div>
</div>
<div *ngFor="let player of standings; let i = index;" class="stats-container mt-2 my-container">
  <div class="position">
    <i *ngIf="i < 3" class="fa-solid fa-medal position-{{ i + 1 }}"></i> {{i+1}}
  </div>

  <img [src]="player.image_url" style="object-fit: cover;" />
  <div class="name">{{ player.playerName }}</div>
  <div class="partite-tot" title="{{ 'partiteTotTitle' | translate }}">{{ player.totalPlayed }}</div>
  <div class="vittorie" title="{{ 'vittorieTitle' | translate }}">{{ player.wins }}</div>
  <div class="sconfitte" title="{{ 'sconfitteTitle' | translate }}">{{ player.lost }}</div>
  <div class="partite-rating" title="{{ 'ratingEloTitle' | translate }}">
    <span class="mini-info">{{ 'pt' | translate }}</span>
    {{ (player.rating)?.toFixed(1) }}
  </div>
  <div class="win-rate" title="{{ 'winRateTitle' | translate }}">
    <span class="mini-info">{{ 'wr_percent' | translate }}</span>
    <div class="rate-label">{{ winRateLabel(player.winRate) }}</div>
    <div class="win-rate-bar" [style.width.%]="barWidthPct(player.winRate)"
      [style.background-color]="barColor(player.winRate)">
    </div>
  </div>
</div>

<section class="mt-5">
  <!-- SCONTRI DIRETTI -->
  <h2 class="mb-3 mt-4">{{ "scontriDiretti" | translate }}</h2>

  <div *ngFor="let row of (headToHead$ | async)" class="headtohead my-container">
    <div class="players">
      <div class="player">
        <img [src]="row.player1_img || 'default-player.jpg'" [alt]="row.player1" />
        <div class="name">{{ row.player1 }}</div>
        <div class="score" [class.winner-color]="row.scored1 > row.scored2">
          {{ row.scored1 }}
        </div>
      </div>

      <div class="vs">
        <img src="/vs.svg" alt="{{ 'vs' | translate }}" />
      </div>

      <div class="player">
        <img [src]="row.player2_img || 'default-player.jpg'" [alt]="row.player2" />
        <div class="name">{{ row.player2 }}</div>
        <div class="score" [class.winner-color]="row.scored2 > row.scored1">
          {{ row.scored2 }}
        </div>
      </div>
    </div>

    <div class="win-bar">
      <ng-container *ngIf="(row.scored1 + row.scored2) as tot; else zero">
        <div class="percent" [class.winner-color]="row.scored1 > row.scored2">
          {{ (row.scored1 * 100 / tot).toFixed(1) }}%
        </div>

        <div class="bars">
          <div
            class="bar left player1"
            [class.winner]="row.scored1 > row.scored2"
            [style.width.%]="barWidth(row.scored1, row.scored1 + row.scored2)">
          </div>
          <div
            class="bar right player2"
            [class.winner]="row.scored2 > row.scored1"
            [style.width.%]="barWidth(row.scored2, row.scored1 + row.scored2)">
          </div>
        </div>

        <div class="percent" [class.winner-color]="row.scored2 > row.scored1">
          {{ (row.scored2 * 100 / tot).toFixed(1) }}%
        </div>
      </ng-container>

      <ng-template #zero>
        <div class="no-data">{{ "nessunDato" | translate }}</div>
      </ng-template>
    </div>
  </div>
</section>